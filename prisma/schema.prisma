// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id            String    @id @default(uuid())
  email         String    @unique
  passwordHash  String
  name          String?
  isAdmin       Boolean   @default(false)
  emailVerified Boolean   @default(false)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  
  simulations   Simulation[]
  
  @@map("users")
}

model Simulation {
  id              String   @id @default(uuid())
  userId          String
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  // Form verileri
  title           String
  description     String?
  particleType    String   // "neutron" | "gamma"
  energy          Float
  energyUnit      String   // "keV" | "MeV"
  particleCount   Int
  
  // Malzeme ve katmanlar (JSON olarak saklanacak)
  materials       Json     // [{id, name, density, components: [...]}]
  layers          Json     // [{materialId, thickness}]
  
  // Dosya yükleme
  uploadedFiles   String[] // Supabase Storage URL'leri
  
  // Durum
  status          String   @default("pending") // "pending" | "processing" | "completed" | "failed"
  
  // Sonuçlar (simülasyon tamamlandığında)
  resultFiles     String[] // Excel, grafik dosyaları
  transmissionRate Float?
  summaryData     Json?
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  completedAt     DateTime?
  
  @@map("simulations")
}
